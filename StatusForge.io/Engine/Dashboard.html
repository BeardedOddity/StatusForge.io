<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>StatusForge.io</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800;900&display=swap');
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; font-family: 'Montserrat', sans-serif; background: #050505; color: white; overflow: hidden; display: flex; }
        
        /* APP LAYOUT */
        .sidebar { width: 260px; background: rgba(20, 20, 20, 0.95); border-right: 1px solid rgba(255, 255, 255, 0.05); padding: 30px 20px; display: flex; flex-direction: column; z-index: 10; box-shadow: 5px 0 30px rgba(0,0,0,0.8); }
        .main-content { flex-grow: 1; position: relative; overflow-y: auto; background: radial-gradient(circle at top right, #1a1a1a, #050505); padding: 40px 60px; }
        .main-content::-webkit-scrollbar { width: 8px; }
        .main-content::-webkit-scrollbar-thumb { background: rgba(0, 255, 136, 0.5); border-radius: 10px; }
        
        /* SIDEBAR NAVIGATION */
        h1.logo { font-weight: 900; font-size: 28px; margin-bottom: 40px; background: linear-gradient(to right, #fff, #666); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-align: center; }
        .nav-btn { background: transparent; border: 1px solid transparent; color: rgba(255,255,255,0.5); font-family: 'Montserrat'; font-weight: 800; font-size: 14px; text-transform: uppercase; letter-spacing: 2px; padding: 15px 20px; text-align: left; border-radius: 15px; margin-bottom: 10px; cursor: pointer; transition: 0.3s; display: flex; align-items: center; gap: 10px; }
        .nav-btn:hover { background: rgba(255,255,255,0.05); color: white; transform: translateX(5px); }
        .nav-btn.active { background: rgba(0,255,136,0.1); border: 1px solid rgba(0,255,136,0.3); color: #00ff88; transform: translateX(5px); box-shadow: 0 0 15px rgba(0,255,136,0.1); }
        
        /* SCREEN MANAGEMENT */
        .screen { display: none; animation: fadeIn 0.4s ease-out; max-width: 1000px; margin: 0 auto; }
        .screen.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* UI COMPONENTS */
        h2.screen-title { font-weight: 900; font-size: 32px; color: white; margin-top: 0; margin-bottom: 30px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px; }
        .card { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(20px); padding: 30px; border-radius: 30px; border: 1px solid rgba(255, 255, 255, 0.05); margin-bottom: 30px; position: relative; }
        label { display: block; font-weight: 700; text-transform: uppercase; font-size: 11px; letter-spacing: 2px; color: rgba(255,255,255,0.4); margin-bottom: 10px; margin-left: 20px; }
        input, select { width: 100%; background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.1); padding: 15px 25px; border-radius: 25px; color: white; font-family: 'Montserrat'; font-weight: 700; font-size: 14px; box-sizing: border-box; }
        input:focus, select:focus { outline: none; border-color: #00ff88; box-shadow: 0 0 15px rgba(0,255,136,0.2); }
        .btn-primary { background: #00ff88; color: black; border: none; padding: 15px 30px; border-radius: 25px; font-weight: 900; text-transform: uppercase; letter-spacing: 2px; cursor: pointer; transition: 0.3s; width: 100%; display: inline-block; text-align: center; }
        .btn-primary:hover { transform: scale(1.02); box-shadow: 0 0 20px rgba(0,255,136,0.4); }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        
        /* LIVE BADGE & SYSTEM TAGS */
        .live-badge { display: flex; align-items: center; gap: 20px; background: rgba(0,255,136,0.05); padding: 25px; border-radius: 30px; border: 1px solid rgba(0,255,136,0.3); }
        .mini-pill { position: relative; width: 80px; height: 110px; border-radius: 20px; overflow: hidden; background-size: cover; background-position: center; border: 1px solid rgba(255,255,255,0.2); background-color: #111; flex-shrink: 0; }
        .shine-layer { position: absolute; top: 0; left: -150%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent); animation: pillShine 4s infinite; }
        @keyframes pillShine { 0% { left: -150%; } 30% { left: 150%; } 100% { left: 150%; } }

        /* OS & DEPENDENCY BADGES */
        .system-badge { position: absolute; top: 20px; right: 20px; display: flex; gap: 10px; }
        .tag { padding: 5px 12px; border-radius: 8px; font-size: 10px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; display: flex; align-items: center; gap: 5px; }
        .tag-os { background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2); }
        .tag-dep-err { background: rgba(255, 68, 68, 0.2); color: #ff4444; border: 1px solid #ff4444; animation: pulseRed 2s infinite; }
        @keyframes pulseRed { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
    </style>
</head>
<body>

    <nav class="sidebar">
        <h1 class="logo">StatusForge</h1>
        <button class="nav-btn active" id="nav-dashboard" onclick="switchScreen('dashboard')">üü¢ Live Dash</button>
        <button class="nav-btn" id="nav-vault" onclick="switchScreen('vault')">üõ°Ô∏è The Vault</button>
        <button class="nav-btn" id="nav-api" onclick="switchScreen('api')">üîë API Keys</button>
        <button class="nav-btn" id="nav-engine" onclick="switchScreen('engine')">‚öôÔ∏è Engine Config</button>
        <button class="nav-btn" id="nav-sb" onclick="switchScreen('sb')">ü§ñ Streamer.bot</button>
        
        <div style="flex-grow: 1;"></div>
        
        <button class="nav-btn" style="color: #ff4444; border: 1px solid rgba(255,68,68,0.2); justify-content: center; background: rgba(255,68,68,0.05);" onclick="shutdownEngine()">üõë SHUT DOWN</button>
    </nav>

    <main class="main-content" id="mainAppArea">

        <div id="screen-dashboard" class="screen active">
            <h2 class="screen-title">Live Status</h2>
            
            <div class="card live-badge">
                <div class="system-badge">
                    <div id="osTag" class="tag tag-os">OS: Scanning...</div>
                    <div id="depAlert" class="tag tag-dep-err" style="display:none;">‚ö†Ô∏è Dependency Missing</div>
                </div>

                <div class="mini-pill" id="miniPill"><div class="shine-layer"></div></div>
                <div style="flex-grow:1;">
                    <label style="margin-left:0; color:#00ff88;">Current Engine Detection</label>
                    <div id="activeTitle" style="font-weight:900; color:white; font-size:32px;">Initializing...</div>
                    <div id="procName" style="font-size:14px; opacity:0.5; font-family: monospace; margin-top:5px;">Scanning system processes...</div>
                    <div id="pathDisplay" style="font-size:10px; opacity:0.3; font-family: monospace; margin-top:5px; text-transform: none;">Path: --</div>
                </div>
            </div>

            <div class="card">
                <h3 style="margin:0 0 15px 0; color:white; font-size: 18px;">OBS Overlay Generator</h3>
                <div style="display:flex; gap:15px; align-items:center;">
                    <select id="layoutChoice" style="flex:1;">
                        <option value="layouts/Horizontal_Left.html">Horizontal Left Overlay</option>
                        <option value="layouts/Horizontal_Right.html">Horizontal Right Overlay</option>
                        <option value="layouts/Vertical.html">Vertical Overlay</option>
                    </select>
                    <button class="btn-primary" onclick="generateUrl()" style="width: auto; padding: 15px 40px;">GET SECURE URL</button>
                </div>
                <div id="urlContainer" style="margin-top:20px; padding:20px; background:rgba(0,255,136,0.1); border:1px dashed #00ff88; border-radius:20px; display:none; text-align:center;">
                    <span id="generatedUrl" style="font-family:monospace; color:#00ff88; display:block; margin-bottom:15px; word-break:break-all;"></span>
                    <button id="copyBtn" class="btn-primary" style="width:auto; padding:10px 20px;" onclick="copyUrl()">COPY FOR OBS</button>
                </div>
            </div>

            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="margin:0; color:white; font-size: 18px;">Engine Terminal</h3>
                    <button onclick="clearLogs()" class="btn-primary" style="width: auto; padding: 8px 15px; font-size: 10px; background: #ff4444; color: white; border-radius: 10px;">PURGE LOGS</button>
                </div>
                <div id="logTerminal" style="background: #000; color: #00ff88; font-family: monospace; font-size: 12px; padding: 20px; height: 150px; overflow-y: auto; border-radius: 15px; border: 1px solid rgba(0, 255, 136, 0.2); white-space: pre-wrap;">Awaiting Engine connection...</div>
            </div>
        </div>

        <div id="screen-vault" class="screen">
            <h2 class="screen-title">The Vault</h2>
            <div class="card" style="border-color: rgba(0,255,136,0.3);">
                <p style="color:rgba(255,255,255,0.6); font-size: 13px; line-height: 1.6; margin-bottom: 20px;">Use this forge to lock in permanent database overrides. Type the exact game name, fill out only the blanks you want to replace, and lock it in.</p>
                <div class="grid-2">
                    <div style="grid-column: 1 / -1;">
                        <label style="color:#00ff88;">1. Target Game Title (Required)</label>
                        <input type="text" id="renameInput" placeholder="Exact Game Title Override" style="border-color: rgba(0,255,136,0.4);">
                    </div>
                    <div style="grid-column: 1 / -1;">
                        <label>Custom Art URL (Overrides API)</label>
                        <input type="text" id="customUrlInput" placeholder="https://...">
                    </div>
                    <div>
                        <label>Custom Release Year</label>
                        <input type="text" id="customReleaseInput" placeholder="e.g. 2024">
                    </div>
                    <div>
                        <label>Custom Genre</label>
                        <input type="text" id="customGenreInput" placeholder="e.g. SURVIVAL HORROR">
                    </div>
                    <div style="grid-column: 1 / -1;">
                        <label>Custom Publisher</label>
                        <input type="text" id="customPublisherInput" placeholder="e.g. AA STUDIO">
                    </div>
                </div>
                <div style="display:flex; gap:15px; margin-top: 30px;">
                    <button onclick="sendToEngine('list')" class="btn-primary" style="flex:2;">üîí LOCK INTO VAULT</button>
                    <button onclick="sendToEngine('delist')" class="btn-primary" style="flex:1; background:#ff4444; color:white;">üíÄ EXILE PROCESS</button>
                </div>
            </div>
        </div>

        <div id="screen-api" class="screen">
            <h2 class="screen-title">Metadata API Keys</h2>
            <div class="card grid-2">
                <div>
                    <label style="color:#00ff88;">1. RAWG API Key (Primary)</label>
                    <input type="password" id="rawgKey" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <div>
                    <label>2. SteamGridDB API Key</label>
                    <input type="password" id="sgdbKey" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <div>
                    <label>3. IGDB Client ID</label>
                    <input type="password" id="igdbClient" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <div>
                    <label>4. IGDB Client Secret</label>
                    <input type="password" id="igdbSecret" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
            </div>
            <p style="font-size: 11px; color: rgba(255,255,255,0.4); text-align: center; margin-bottom: 20px;">* GOG.com database is searched automatically and requires no API key.</p>
            <button onclick="saveSettings()" class="btn-primary">SAVE API CONFIGURATION</button>
        </div>

        <div id="screen-engine" class="screen">
            <h2 class="screen-title">Engine Configuration</h2>
            <div class="card grid-2">
                <div>
                    <label>Idle / Fallback Category</label>
                    <input type="text" id="idleCategory" placeholder="Just Chatting">
                </div>
                <div>
                    <label>OBS Widget Polling (Seconds)</label>
                    <input type="number" id="widgetPollRate" placeholder="3">
                </div>
                <div style="grid-column: 1 / -1;">
                    <label>Widget Fade Timer (Seconds) - Set to 0 for always visible</label>
                    <input type="number" id="widgetFadeTimer" placeholder="15" min="0" max="300">
                </div>
            </div>
            <button onclick="saveSettings()" class="btn-primary" style="margin-bottom: 30px;">SAVE ENGINE CONFIGURATION</button>

            <div class="card" style="border-color: rgba(0, 255, 136, 0.2);">
                <h3 style="margin:0 0 10px 0; font-size:16px; color:#00ff88;">SYSTEM MAINTENANCE</h3>
                <p style="font-size:12px; opacity:0.6; margin-bottom:20px;">Missing dependencies? Click below to auto-install xdotool (Linux), Win32 extensions (Windows), and core Python libraries.</p>
                <button onclick="triggerRepair()" id="repairBtn" class="btn-primary" style="background:transparent; border: 1px solid #00ff88; color:#00ff88;">üõ†Ô∏è RUN SYSTEM REPAIR</button>
            </div>
        </div>

        <div id="screen-sb" class="screen">
            <h2 class="screen-title">Streamer.bot Integration</h2>
            <div class="card grid-2">
                <div>
                    <label>Auto-Push Categories</label>
                    <select id="autoPushToggle" onchange="toggleManualUI(this.value === 'true')">
                        <option value="false">Off (Manual Mode)</option>
                        <option value="true">On (Automated Mode)</option>
                    </select>
                </div>
                <div>
                    <label style="color:#ff4444;">Broadcast Safe Mode</label>
                    <select id="safeModeToggle" style="border-color: rgba(255,68,68,0.5);">
                        <option value="false">Off (Stream goes LIVE)</option>
                        <option value="true">On (Blocks Streamer.bot Pings)</option>
                    </select>
                </div>
                <div style="grid-column: 1 / -1;">
                    <label>Streamer.bot HTTP Server Port</label>
                    <input type="number" id="sbPort" placeholder="8080">
                </div>
            </div>
            <button onclick="saveSettings()" class="btn-primary" style="margin-bottom: 30px;">SAVE STREAMER.BOT CONFIGURATION</button>

            <div class="card" id="manualPushSection" style="border-color: rgba(0,255,136,0.3); background: rgba(0,255,136,0.02); transition: opacity 0.3s;">
                <h3 style="margin:0 0 15px 0; font-size:16px; color:#00ff88; text-transform:uppercase; font-weight:900;">Manual Category Push</h3>
                <div style="display:flex; gap:15px;">
                    <input type="text" id="pushCategory" placeholder="Category Override (Leave blank to use detected game)" style="flex: 1;">
                    <button onclick="pushToStream()" class="btn-primary" style="width:auto; padding: 15px 40px;">PUSH LIVE</button>
                </div>
            </div>
        </div>

    </main>

    <script>
        let currentProc = ""; let lastTitle = "";
        let statusInterval, logsInterval;

        window.onload = () => {
            loadSettings();
            statusInterval = setInterval(updateStatus, 3000);
            logsInterval = setInterval(fetchLogs, 3000);
        };

        function switchScreen(screenId) {
            document.querySelectorAll('.screen').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            document.getElementById('screen-' + screenId).classList.add('active');
            document.getElementById('nav-' + screenId).classList.add('active');
        }

        async function updateStatus() {
            try {
                const url = 'http://127.0.0.1:5050/status?nocache=' + new Date().getTime();
                const res = await fetch(url);
                const data = await res.json();

                // 1. OS Detection Badge
                const osBadge = document.getElementById('osTag');
                const os = data.system_info?.os || "Unknown";
                osBadge.innerText = `OS: ${os}`;
                
                // 2. Dependency Alert
                const depAlert = document.getElementById('depAlert');
                if (os === "Linux" && data.system_info?.missing_deps?.includes('xdotool')) {
                    depAlert.style.display = 'block';
                    depAlert.title = "Scout requires 'xdotool' to track windows on Linux.";
                } else {
                    depAlert.style.display = 'none';
                }

                // 3. Path Awareness
                const pathDisplay = document.getElementById('pathDisplay');
                pathDisplay.innerText = `Asset Path: ${data.system_info?.active_path || '--'}`;

                document.getElementById('activeTitle').innerText = data.game_title;

                if(data.is_playing) {
                    document.getElementById('procName').innerText = "Tracking: " + data.process_name;
                    currentProc = data.process_name;
                    if(data.game_title !== lastTitle) {
                        lastTitle = data.game_title;
                        document.getElementById('miniPill').style.backgroundImage = data.cover_url ? `url('${data.cover_url}')` : 'none';
                    }
                } else {
                    document.getElementById('procName').innerText = "Monitoring system processes...";
                    document.getElementById('miniPill').style.backgroundImage = 'none';
                    lastTitle = "";
                }
            } catch(e) { document.getElementById('osTag').innerText = "OS: Offline"; }
        }

        async function loadSettings() {
            try {
                const res = await fetch('http://127.0.0.1:5050/settings');
                const data = await res.json();
                document.getElementById('autoPushToggle').value = data.auto_push ? "true" : "false";
                document.getElementById('safeModeToggle').value = data.safe_mode ? "true" : "false";
                document.getElementById('idleCategory').value = data.idle_category || "Just Chatting";
                document.getElementById('sbPort').value = data.sb_port || 8080;
                document.getElementById('widgetPollRate').value = data.widget_poll_rate || 3;
                document.getElementById('widgetFadeTimer').value = data.widget_fade_timer !== undefined ? data.widget_fade_timer : 15;
                document.getElementById('rawgKey').value = data.rawg_key || "";
                document.getElementById('sgdbKey').value = data.sgdb_key || "";
                document.getElementById('igdbClient').value = data.igdb_client || "";
                document.getElementById('igdbSecret').value = data.igdb_secret || ""; 
                toggleManualUI(data.auto_push);
            } catch(e) {}
        }

        async function saveSettings() {
            const isAuto = document.getElementById('autoPushToggle').value === "true";
            toggleManualUI(isAuto);
            await fetch('http://127.0.0.1:5050/settings', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ 
                    auto_push: isAuto,
                    safe_mode: document.getElementById('safeModeToggle').value === "true",
                    idle_category: document.getElementById('idleCategory').value,
                    sb_port: parseInt(document.getElementById('sbPort').value) || 8080,
                    scan_interval: 5,
                    widget_poll_rate: parseInt(document.getElementById('widgetPollRate').value) || 3,
                    widget_fade_timer: parseInt(document.getElementById('widgetFadeTimer').value) >= 0 ? parseInt(document.getElementById('widgetFadeTimer').value) : 15,
                    rawg_key: document.getElementById('rawgKey').value,
                    sgdb_key: document.getElementById('sgdbKey').value,
                    igdb_client: document.getElementById('igdbClient').value,
                    igdb_secret: document.getElementById('igdbSecret').value
                })
            });
            alert("‚úÖ Settings synced.");
        }

        function toggleManualUI(isAuto) {
            const manualSec = document.getElementById('manualPushSection');
            manualSec.style.opacity = isAuto ? "0.2" : "1"; 
            manualSec.style.pointerEvents = isAuto ? "none" : "auto";
        }

        async function pushToStream() {
            const category = document.getElementById('pushCategory').value;
            await fetch('http://127.0.0.1:5050/push-stream', {
                method: 'POST', headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ category: category })
            });
            document.getElementById('pushCategory').value = "";
        }

        async function sendToEngine(action) {
            const title = document.getElementById('renameInput').value;
            if (action === 'list' && !title) { alert("Game Title Required."); return; }
            await fetch(`http://127.0.0.1:5050/${action}`, {
                method: 'POST', headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ 
                    process: currentProc, title: title, 
                    custom_url: document.getElementById('customUrlInput').value,
                    custom_release: document.getElementById('customReleaseInput').value,
                    custom_genre: document.getElementById('customGenreInput').value,
                    custom_publisher: document.getElementById('customPublisherInput').value
                })
            });
            if(action === 'list') alert("Vault Updated.");
        }

        async function triggerRepair() {
            if(!confirm("Attempt dependency install? (Check Terminal for prompts/sudo)")) return;
            const btn = document.getElementById('repairBtn');
            btn.innerText = "REPAIRING...";
            try {
                await fetch('http://127.0.0.1:5050/repair-engine', { method: 'POST' });
                alert("Repair initiated. Watch the terminal logs.");
            } catch(e) { alert("Failed to reach Engine."); }
            setTimeout(() => btn.innerText = "üõ†Ô∏è RUN SYSTEM REPAIR", 5000);
        }

        async function generateUrl() {
            const layout = document.getElementById('layoutChoice').value;
            const res = await fetch('http://127.0.0.1:5050/get-token');
            const data = await res.json();
            document.getElementById('generatedUrl').innerText = `http://127.0.0.1:5050/forge-widget/${data.token}/${layout}`;
            document.getElementById('urlContainer').style.display = 'block';
        }

        function copyUrl() {
            navigator.clipboard.writeText(document.getElementById('generatedUrl').innerText);
            document.getElementById('copyBtn').innerText = "COPIED!";
            setTimeout(() => document.getElementById('copyBtn').innerText = "COPY FOR OBS", 2000);
        }

        async function fetchLogs() {
            try {
                const res = await fetch('http://127.0.0.1:5050/logs');
                const data = await res.json();
                const term = document.getElementById('logTerminal');
                term.innerText = data.logs.join('');
                term.scrollTop = term.scrollHeight;
            } catch(e) {}
        }

        async function clearLogs() {
            await fetch('http://127.0.0.1:5050/clear-logs', { method: 'POST' });
            document.getElementById('logTerminal').innerText = "Logs purged.\n";
        }
        
        async function shutdownEngine() {
            if(!confirm("Power down StatusForge?")) return;
            try { await fetch('http://127.0.0.1:5050/shutdown', { method: 'POST' }); } catch(e) {}
            clearInterval(statusInterval);
            clearInterval(logsInterval);
            document.getElementById('mainAppArea').innerHTML = `
                <div style="display:flex; flex-direction:column; justify-content:center; align-items:center; height:100%; text-align:center;">
                    <h1 style="color:#ff4444; font-size:48px; font-weight:900;">SYSTEM OFFLINE</h1>
                    <p style="color:rgba(255,255,255,0.5);">Process terminated. You may close this tab.</p>
                </div>`;
        }
    </script>
</body>
</html>
